// 暗色模式混合宏和通用样式
// 用于减少重复代码，统一暗色模式样式管理

// 暗色模式媒体查询混合宏
@mixin dark-mode {
    @media (prefers-color-scheme: dark) {
        @content;
    }
}

// 认证页面通用样式混合宏
@mixin auth-page-base-styles {
    .auth-container {
        display: flex;
        flex-direction: column-reverse;
        background: $background;

        @media (width >= 768px) {
            flex-direction: row;
        }
    }

    .auth-left {
        display: flex;
        flex-direction: column;
        justify-content: center;
        min-height: 20vh;
        padding: 1rem;
        color: $background-light;
        text-align: center;

        .auth-logo img {
            width: 80%;
            max-width: 160px;
        }

        @media (width >= 768px) {
            width: 50%;
            min-height: 100vh;

            .auth-logo img {
                width: 25%;
                max-width: none;
            }
        }
    }

    .auth-right {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 60vh;
        padding: 1rem;

        @media (width >= 768px) {
            width: 50%;
            min-height: 100vh;
        }
    }

    .auth-card {
        width: 100%;
        max-width: 450px;
        padding: 2rem;
        background-color: $background-light;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgb(0 0 0 / 0.05);
    }

    .auth-title {
        margin-bottom: 1rem;
        color: $secondary;
        font-weight: 600;
        font-size: 2rem;
    }

    .auth-subtitle {
        margin-bottom: 2rem;
        color: $secondary-light;
    }

    .toggle-login {
        margin-top: 1.5rem;
        color: $secondary-light;
        text-align: center;
    }

    .toggle-link {
        color: $primary;
        font-weight: 500;
        text-decoration: none;

        &:hover {
            text-decoration: underline;
        }
    }

    .separator {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        justify-content: center;
        margin: 2rem 0;
        color: $secondary-light;

        &::before,
        &::after {
            flex: 1;
            border-bottom: 1px solid $secondary-bg;
            content: "";
        }

        &::before {
            margin-right: 1rem;
        }

        &::after {
            margin-left: 1rem;
        }
    }

    .agreement-notice {
        margin-top: 0.75rem;
        color: $secondary-light;
        font-size: 0.85rem;
        line-height: 1.4;
        text-align: center;
    }

    .agreement-link {
        color: $primary;
        font-weight: 500;
        text-decoration: none;

        &:hover {
            text-decoration: underline;
        }
    }
}

// 认证页面通用暗色模式样式混合宏
@mixin auth-page-dark-theme {
    @include dark-mode {
        .auth-container {
            background: #{$dark-background} !important;
        }

        .auth-card {
            background-color: #{$dark-background-light} !important;
            box-shadow: 0 10px 25px rgb(0 0 0 / 0.3) !important;
        }

        .auth-title {
            color: #{$dark-secondary} !important;
        }

        .auth-subtitle {
            color: #{$dark-secondary-light} !important;
        }

        .form-label {
            color: #{$dark-secondary} !important;
        }

        .toggle-login {
            color: #{$dark-secondary-light} !important;
        }
    }
}

        // SSO 提供商页面暗色模式
        .sso-provider-config {
            background: #{$dark-background-light} !important;
            border-color: #{$dark-border-color} !important;

            .config-section {
                h4 {
                    color: #{$dark-secondary} !important;
                }

                .field {
                    label {
                        color: #{$dark-secondary} !important;
                    }

                    .p-inputtext,
                    .p-textarea {
                        background: #{$dark-background} !important;
                        border-color: #{$dark-border-color} !important;
                        color: #{$dark-secondary} !important;

                        &::placeholder {
                            color: #{$dark-secondary-light} !important;
                        }
                    }

                    .p-checkbox .p-checkbox-box {
                        background: #{$dark-background} !important;
                        border-color: #{$dark-border-color} !important;

                        .p-checkbox-icon {
                            color: #{$primary} !important;
                        }
                    }
                }
            }
        }

        .provider-form {
            .field {
                label {
                    color: #{$dark-secondary} !important;
                }

                .p-inputtext {
                    background: #{$dark-background} !important;
                    border-color: #{$dark-border-color} !important;
                    color: #{$dark-secondary} !important;

                    &::placeholder {
                        color: #{$dark-secondary-light} !important;
                    }
                }

                .p-checkbox .p-checkbox-box {
                    background: #{$dark-background} !important;
                    border-color: #{$dark-border-color} !important;

                    &.p-highlight {
                        background: #{$primary} !important;
                        border-color: #{$primary} !important;
                    }
                }

                .p-checkbox-label {
                    color: #{$dark-secondary} !important;
                }
            }
        }

// 文本颜色混合宏
@mixin dark-text-primary {
    @include dark-mode {
        color: #{$dark-secondary} !important;
    }
}

@mixin dark-text-secondary {
    @include dark-mode {
        color: #{$dark-secondary-light} !important;
    }
}

// 背景色混合宏
@mixin dark-background-primary {
    @include dark-mode {
        background-color: #{$dark-background} !important;
    }
}

@mixin dark-background-secondary {
    @include dark-mode {
        background-color: #{$dark-background-light} !important;
    }
}

// 卡片/容器暗色模式混合宏
@mixin dark-card {
    @include dark-mode {
        background-color: #{$dark-background-light} !important;
        box-shadow: 0 10px 25px rgb(0 0 0 / 0.3) !important;
        border-color: #{$dark-border-color} !important;
    }
}

// 边框颜色混合宏
@mixin dark-border {
    @include dark-mode {
        border-color: #{$dark-border-color} !important;
    }
}

// 表单输入框暗色模式混合宏
@mixin dark-input {
    @include dark-mode {
        background-color: #{$dark-background-light} !important;
        color: #{$dark-secondary} !important;
        border-color: #{$dark-border-color} !important;

        &::placeholder {
            color: #{$dark-secondary-light} !important;
        }

        &:focus {
            border-color: #{$primary} !important;
            box-shadow: 0 0 0 3px rgba(230, 57, 70, 0.3) !important;
        }
    }
}

// 按钮暗色模式混合宏
@mixin dark-button-secondary {
    @include dark-mode {
        background-color: #{$dark-background-light} !important;
        border-color: #{$dark-border-color} !important;
        color: #{$dark-secondary} !important;

        &:hover {
            background-color: #{$dark-border-color} !important;
        }
    }
}

// 社交登录按钮暗色模式混合宏
@mixin dark-social-button {
    @include dark-button-secondary;
}

// 通用暗色模式工具类
// 这些类可以直接在 HTML 中使用，无需编写额外的 CSS

// 文本颜色工具类的暗色模式
.text-primary {
    @include dark-text-primary;
}

.text-secondary {
    @include dark-text-secondary;
}

// 背景色工具类的暗色模式
.bg-primary {
    @include dark-background-primary;
}

.bg-secondary {
    @include dark-background-secondary;
}

// 卡片样式工具类的暗色模式
.card-dark {
    @include dark-card;
}

// 输入框样式工具类的暗色模式
.input-dark {
    @include dark-input;
}

// 按钮样式工具类的暗色模式
.btn-secondary-dark {
    @include dark-button-secondary;
}

// 社交按钮样式工具类的暗色模式
.social-btn-dark {
    @include dark-social-button;
}

// Footer 组件暗色模式混合宏
@mixin footer-dark-theme {
    @include dark-mode {
        .app-footer {
            background: #{$dark-background-light} !important;
            border-top-color: #{$dark-border-color} !important;
        }

        .app-footer__left {
            color: #{$dark-secondary} !important;

            .font-medium {
                color: #{$dark-secondary} !important;
            }
        }

        .app-footer__links {
            .app-footer__link {
                color: #{$dark-secondary-light} !important;

                &:hover {
                    color: #{$primary} !important;
                }
            }
        }

        .app-footer__bottom {
            .text-gray-500 {
                color: #{$dark-secondary-light} !important;
            }

            .app-footer__bottom-links {
                .app-footer__bottom-link {
                    color: #{$dark-secondary-light} !important;

                    &:hover {
                        color: #{$primary} !important;
                    }
                }
            }
        }
    }
}

// 后台管理布局暗色模式混合宏
@mixin admin-layout-dark-theme {
    @include dark-mode {
        .admin-layout {
            background: #{$dark-background} !important;
        }

        .admin-sidebar {
            background: #{$dark-background-light} !important;
            border-right-color: #{$dark-border-color} !important;
        }

        .sidebar-header {
            border-bottom-color: #{$dark-border-color} !important;

            .app-name {
                color: #{$primary} !important;
            }

            .collapse-btn {
                color: #{$dark-secondary} !important;

                &:hover {
                    color: #{$primary} !important;
                    background: #{$primary-950} !important;
                }
            }
        }

        .nav-title {
            color: #{$dark-secondary-light} !important;
        }

        .nav-item {
            color: #{$dark-secondary} !important;

            &:hover {
                color: #{$primary} !important;
                background: #{$primary-950} !important;
            }

            &.active {
                color: #{$primary} !important;
                background: #{$primary-900} !important;
            }
        }
    }
}

// 后台管理页面通用暗色模式混合宏
@mixin admin-page-dark-theme {
    @include dark-mode {
        // 页面容器
        .admin-users,
        .admin-logs,
        .admin-clients,
        .admin-sso {
            background: linear-gradient(135deg, #{$dark-background} 0%, #{$dark-background-light} 100%) !important;
        }

        // 头部区域
        .users-header,
        .logs-header,
        .clients-header,
        .sso-header {
            background: #{$dark-background-light} !important;
            box-shadow: 0 2px 8px rgb(0 0 0 / 0.3) !important;

            .users-title,
            .logs-title,
            .clients-title,
            .sso-title {
                color: #{$dark-secondary} !important;
            }

            .users-subtitle,
            .logs-subtitle,
            .clients-subtitle,
            .sso-subtitle {
                color: #{$dark-secondary-light} !important;
            }
        }

        // 筛选区域
        .users-filters,
        .sso-filters,
        .clients-filters {
            background: #{$dark-background-light} !important;
            box-shadow: 0 2px 8px rgb(0 0 0 / 0.3) !important;
        }

        // 列表区域
        .users-list,
        .logs-detail,
        .clients-list,
        .sso-list {
            background: #{$dark-background-light} !important;
            box-shadow: 0 2px 8px rgb(0 0 0 / 0.3) !important;

            .table-header {
                background: linear-gradient(135deg, #{$dark-background} 0%, #{$dark-background-light} 100%) !important;
                border-bottom-color: #{$dark-border-color} !important;

                .table-title,
                .users-title,
                .logs-title,
                .clients-title,
                .sso-title {
                    color: #{$dark-secondary} !important;
                }
            }
        }

        // 统计卡片
        .stat-card,
        .period-stats,
        .provider-stats,
        .trend-chart {
            background: #{$dark-background-light} !important;
            box-shadow: 0 2px 8px rgb(0 0 0 / 0.3) !important;

            .stat-value {
                color: #{$dark-secondary} !important;
            }

            .stat-label {
                color: #{$dark-secondary-light} !important;
            }

            .section-title {
                color: #{$primary} !important;
            }

            .section-header {
                background: linear-gradient(135deg, #{$dark-background} 0%, #{$dark-background-light} 100%) !important;
                border-bottom-color: #{$dark-border-color} !important;
            }
        }

        // 期间统计卡片
        .period-card {
            border-right-color: #{$dark-border-color} !important;

            &:hover {
                background: #{$dark-background} !important;
            }

            .period-label {
                color: #{$dark-secondary-light} !important;
            }

            .period-value {
                color: #{$dark-secondary} !important;
            }
        }

        // 用户信息
        .user-details {
            .user-name {
                color: #{$dark-secondary} !important;
            }

            .user-email {
                color: #{$dark-secondary-light} !important;
            }
        }

        // 应用信息
        .application-info {
            .application-name {
                color: #{$dark-secondary} !important;
            }

            .application-description {
                color: #{$dark-secondary-light} !important;
            }
        }

        // 提供商信息
        .provider-info {
            .provider-name {
                color: #{$dark-secondary} !important;
            }

            .provider-description {
                color: #{$dark-secondary-light} !important;
            }
        }

        // PrimeVue 表格暗色模式
        :deep(.p-datatable) {
            .p-datatable-header {
                background: #{$dark-background} !important;
                border-color: #{$dark-border-color} !important;
                color: #{$dark-secondary} !important;
            }

            .p-datatable-thead > tr > th {
                background: #{$dark-background} !important;
                border-color: #{$dark-border-color} !important;
                color: #{$dark-secondary} !important;
            }

            .p-datatable-tbody > tr {
                background: #{$dark-background-light} !important;
                border-color: #{$dark-border-color} !important;

                &:nth-child(even) {
                    background: #{$dark-background} !important;
                }

                > td {
                    border-color: #{$dark-border-color} !important;
                    color: #{$dark-secondary} !important;
                }
            }

            .p-datatable-footer {
                background: #{$dark-background} !important;
                border-color: #{$dark-border-color} !important;
                color: #{$dark-secondary} !important;
            }
        }

        // PrimeVue 分页器暗色模式
        :deep(.p-paginator) {
            background: #{$dark-background} !important;
            border-color: #{$dark-border-color} !important;
            color: #{$dark-secondary} !important;

            .p-paginator-pages .p-paginator-page {
                color: #{$dark-secondary} !important;
                background: transparent !important;

                &.p-highlight {
                    background: #{$primary} !important;
                    color: white !important;
                }

                &:hover {
                    background: #{$dark-border-color} !important;
                }
            }

            .p-paginator-first,
            .p-paginator-prev,
            .p-paginator-next,
            .p-paginator-last {
                color: #{$dark-secondary} !important;

                &:hover {
                    background: #{$dark-border-color} !important;
                }
            }
        }

        // 图表容器
        .chart-container {
            background: #{$dark-background-light} !important;
        }

        // 详情页头部
        .detail-header {
            background: linear-gradient(135deg, #{$dark-background} 0%, #{$dark-background-light} 100%) !important;
            border-bottom-color: #{$dark-border-color} !important;
        }

        // 文本颜色
        .text-gray-500 {
            color: #{$dark-secondary-light} !important;
        }

        // 设备信息
        .device-cell {
            color: #{$dark-secondary} !important;
        }

        // 用户单元格
        .user-cell {
            .user-name {
                color: #{$dark-secondary} !important;
            }

            .user-email {
                color: #{$dark-secondary-light} !important;
            }
        }

        // 提供商单元格
        .provider-cell {
            color: #{$dark-secondary} !important;
        }

        // 客户端ID
        .client-id {
            color: #{$dark-secondary-light} !important;
        }

        // 日期信息
        .date-info {
            color: #{$dark-secondary-light} !important;
        }

        // PrimeVue 对话框暗色模式
        :deep(.p-dialog) {
            .p-dialog-header {
                background: #{$dark-background-light} !important;
                border-bottom-color: #{$dark-border-color} !important;

                .p-dialog-title {
                    color: #{$dark-secondary} !important;
                }

                .p-dialog-header-icon {
                    color: #{$dark-secondary} !important;
                }
            }

            .p-dialog-content {
                background: #{$dark-background-light} !important;
                color: #{$dark-secondary} !important;
            }

            .p-dialog-footer {
                background: #{$dark-background-light} !important;
                border-top-color: #{$dark-border-color} !important;
            }
        }

        // 对话框内容暗色模式
        .user-detail {
            .detail-section {
                h3 {
                    color: #{$primary} !important;
                }

                .detail-item {
                    label {
                        color: #{$dark-secondary-light} !important;
                    }

                    span {
                        color: #{$dark-secondary} !important;
                    }

                    .detail-label {
                        color: #{$dark-secondary-light} !important;
                    }

                    .detail-value {
                        color: #{$dark-secondary} !important;
                    }
                }

                .verification-status {
                    display: flex;
                    gap: 0.5rem;
                    flex-wrap: wrap;
                }
            }
        }

        // 表单字段暗色模式
        .create-user-form,
        .ban-form {
            .field {
                label {
                    color: #{$dark-secondary} !important;
                }

                small {
                    color: #{$dark-secondary-light} !important;
                }
            }

            .dialog-footer {
                border-top-color: #{$dark-border-color} !important;
            }
        }

        // 通用表单输入框和标签暗色模式
        .p-dialog {
            label {
                color: #{$dark-secondary} !important;
            }

            .p-inputtext,
            .p-dropdown,
            .p-textarea {
                background: #{$dark-background} !important;
                border-color: #{$dark-border-color} !important;
                color: #{$dark-secondary} !important;

                &::placeholder {
                    color: #{$dark-secondary-light} !important;
                }
            }

            .p-dropdown-label {
                color: #{$dark-secondary} !important;
            }

            .p-dropdown-panel {
                background: #{$dark-background-light} !important;
                border-color: #{$dark-border-color} !important;

                .p-dropdown-items .p-dropdown-item {
                    color: #{$dark-secondary} !important;

                    &.p-highlight {
                        background: #{$primary} !important;
                        color: white !important;
                    }

                    &:hover {
                        background: #{$dark-border-color} !important;
                    }
                }
            }
        }

        // 会话详情暗色模式
        .user-sessions {
            .sessions-header {
                border-bottom-color: #{$dark-border-color} !important;

                h4 {
                    color: #{$primary} !important;
                }
            }

            .session-id {
                background: #{$dark-border-color} !important;
                color: #{$dark-secondary} !important;
            }

            .device-info {
                div {
                    color: #{$dark-secondary} !important;
                }

                small {
                    color: #{$dark-secondary-light} !important;
                }
            }
        }

        // 验证标签暗色模式
        .verification-tags {
            .p-tag {
                background: #{$dark-border-color} !important;
                color: #{$dark-secondary} !important;
            }
        }

        // 用户状态暗色模式
        .user-status {
            .ban-reason,
            .ban-expires {
                color: #{$dark-secondary-light} !important;
            }
        }

        // 消息和通知组件暗色模式
        .p-toast {
            .p-toast-message {
                background: #{$dark-background-light} !important;
                border-color: #{$dark-border-color} !important;
                color: #{$dark-secondary} !important;

                .p-toast-message-content {
                    .p-toast-summary,
                    .p-toast-detail {
                        color: #{$dark-secondary} !important;
                    }
                }

                &.p-toast-message-success {
                    background: rgba(74, 222, 128, 0.1) !important;
                    border-color: rgba(74, 222, 128, 0.3) !important;

                    .p-toast-message-content {
                        .p-toast-summary,
                        .p-toast-detail {
                            color: rgb(74, 222, 128) !important;
                        }
                    }
                }

                &.p-toast-message-error {
                    background: rgba(239, 68, 68, 0.1) !important;
                    border-color: rgba(239, 68, 68, 0.3) !important;

                    .p-toast-message-content {
                        .p-toast-summary,
                        .p-toast-detail {
                            color: rgb(239, 68, 68) !important;
                        }
                    }
                }

                &.p-toast-message-warn {
                    background: rgba(245, 158, 11, 0.1) !important;
                    border-color: rgba(245, 158, 11, 0.3) !important;

                    .p-toast-message-content {
                        .p-toast-summary,
                        .p-toast-detail {
                            color: rgb(245, 158, 11) !important;
                        }
                    }
                }

                &.p-toast-message-info {
                    background: rgba(59, 130, 246, 0.1) !important;
                    border-color: rgba(59, 130, 246, 0.3) !important;

                    .p-toast-message-content {
                        .p-toast-summary,
                        .p-toast-detail {
                            color: rgb(59, 130, 246) !important;
                        }
                    }
                }
            }
        }

        // 确认对话框暗色模式
        .p-confirm-dialog {
            background: #{$dark-background-light} !important;
            border-color: #{$dark-border-color} !important;

            .p-dialog-header {
                background: #{$dark-background-light} !important;
                color: #{$dark-secondary} !important;
                border-bottom-color: #{$dark-border-color} !important;
            }

            .p-dialog-content {
                background: #{$dark-background-light} !important;
                color: #{$dark-secondary} !important;
            }

            .p-dialog-footer {
                background: #{$dark-background-light} !important;
                border-top-color: #{$dark-border-color} !important;
            }
        }
    }
}
